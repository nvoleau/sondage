
<!DOCTYPE html>
<html>
<head>
	<title>Carte</title>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.0-beta.2/leaflet.css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.0-beta.2/leaflet.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="stylesheet" href="http://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.css" />
	<script src="http://leaflet.github.io/Leaflet.markercluster/dist/leaflet.markercluster-src.js"></script>


	<link rel="stylesheet" href="http://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="./map.css" />

	
	<script src="votant.js"></script>

</head>
<body>

	<div id="map"></div>
	<span>Pavillon 30</span>
	<script type="text/javascript">

		var tiles = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
				maxZoom: 18,
				//attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors, Points &copy 2012 LINZ'
			}),
			latlng = L.latLng(48.5400906,2.6126114);

		var cities = new L.LayerGroup();

		var map = L.map('map', {center: latlng, zoom: 13, layers: [tiles,cities]});


     var impot = L.geoJson({
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "GID": 255331,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0103",
        "DCOMIRIS": 772850103,
        "NOM_IRIS": "COURTILLERAIES EST SUD",
        "TYP_IRIS": "H",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Courtilleraies Est Sud",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"38",
    "COLOR":'#ffffb2',
		"CHOMAGE_2012":10.4
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.6315937,
              48.5428407
            ],
            [
              2.6312098,
              48.539646
            ],
            [
              2.6295413,
              48.5380486
            ],
            [
              2.626201,
              48.5391626
            ],
            [
              2.6288093,
              48.5419504
            ],
            [
              2.6262605,
              48.5441194
            ],
            [
              2.6260983,
              48.545972
            ],
            [
              2.6211112,
              48.5461451
            ],
            [
              2.6211175,
              48.5462914
            ],
            [
              2.6236875,
              48.5462641
            ],
            [
              2.6238864,
              48.5484374
            ],
            [
              2.6250126,
              48.5481186
            ],
            [
              2.6294022,
              48.5443091
            ],
            [
              2.6318119,
              48.5445685
            ],
            [
              2.6315937,
              48.5428407
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "GID": 255332,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0101",
        "DCOMIRIS": 772850101,
        "NOM_IRIS": "COURTILLERAIES OUEST",
        "TYP_IRIS": "H",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Courtilleraies Ouest",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"43.3",
    "COLOR":'#f03b20',
		"CHOMAGE_2012":16.2
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.6295413,
              48.5380486
            ],
            [
              2.621815,
              48.5349837
            ],
            [
              2.6194096,
              48.5341934
            ],
            [
              2.6179563,
              48.53396
            ],
            [
              2.6145163,
              48.5354583
            ],
            [
              2.6114346,
              48.5366396
            ],
            [
              2.6096769,
              48.5410257
            ],
            [
              2.6110966,
              48.5424939
            ],
            [
              2.6176666,
              48.5470926
            ],
            [
              2.621078,
              48.5462918
            ],
            [
              2.6211175,
              48.5462914
            ],
            [
              2.6211112,
              48.5461451
            ],
            [
              2.6171125,
              48.5464202
            ],
            [
              2.6189997,
              48.5440064
            ],
            [
              2.626201,
              48.5391626
            ],
            [
              2.6295413,
              48.5380486
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "GID": 255333,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0104",
        "DCOMIRIS": 772850104,
        "NOM_IRIS": "BOIS DE MARCHE MARAIS",
        "TYP_IRIS": "D",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Bois De Marche Marais",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"100",
		"CHOMAGE_2012":0
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.6401444,
              48.5484442
            ],
            [
              2.6350676,
              48.547853
            ],
            [
              2.6328548,
              48.5465418
            ],
            [
              2.6318119,
              48.5445685
            ],
            [
              2.6294022,
              48.5443091
            ],
            [
              2.6250126,
              48.5481186
            ],
            [
              2.6238864,
              48.5484374
            ],
            [
              2.6239013,
              48.5486011
            ],
            [
              2.6228241,
              48.5505906
            ],
            [
              2.6281113,
              48.5513905
            ],
            [
              2.6293686,
              48.5532615
            ],
            [
              2.6401556,
              48.5500835
            ],
            [
              2.6414573,
              48.5493693
            ],
            [
              2.6416021,
              48.5493235
            ],
            [
              2.6415614,
              48.5492671
            ],
            [
              2.6417162,
              48.5484129
            ],
            [
              2.6401444,
              48.5484442
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "GID": 255334,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0102",
        "DCOMIRIS": 772850102,
        "NOM_IRIS": "COURTILLERAIES CENTRE",
        "TYP_IRIS": "H",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Courtilleraies Centre",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"54.3",
		"CHOMAGE_2012":20.9
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.626201,
              48.5391626
            ],
            [
              2.6189997,
              48.5440064
            ],
            [
              2.6171125,
              48.5464202
            ],
            [
              2.6211112,
              48.5461451
            ],
            [
              2.6260983,
              48.545972
            ],
            [
              2.6262605,
              48.5441194
            ],
            [
              2.6288093,
              48.5419504
            ],
            [
              2.626201,
              48.5391626
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "GID": 255335,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0301",
        "DCOMIRIS": 772850301,
        "NOM_IRIS": "VILLAGE",
        "TYP_IRIS": "H",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Village",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"22.8",
		"CHOMAGE_2012":9
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.641411,
              48.5395602
            ],
            [
              2.6485646,
              48.5394107
            ],
            [
              2.648754,
              48.5393938
            ],
            [
              2.6486484,
              48.5388732
            ],
            [
              2.6512089,
              48.5381932
            ],
            [
              2.6514421,
              48.5372858
            ],
            [
              2.6472644,
              48.5361986
            ],
            [
              2.6441175,
              48.5346415
            ],
            [
              2.6409991,
              48.5329407
            ],
            [
              2.6373764,
              48.5303059
            ],
            [
              2.6319772,
              48.5275948
            ],
            [
              2.6279527,
              48.5316028
            ],
            [
              2.6248799,
              48.5292115
            ],
            [
              2.6162065,
              48.5269598
            ],
            [
              2.6087286,
              48.5307776
            ],
            [
              2.6182681,
              48.5338242
            ],
            [
              2.6179563,
              48.53396
            ],
            [
              2.6194096,
              48.5341934
            ],
            [
              2.621815,
              48.5349837
            ],
            [
              2.6295413,
              48.5380486
            ],
            [
              2.6366302,
              48.5393928
            ],
            [
              2.641411,
              48.5395602
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "GID": 255336,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0204",
        "DCOMIRIS": 772850204,
        "NOM_IRIS": "CROIX BLANCHE-PLEIN CIEL-SUD-EST",
        "TYP_IRIS": "H",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Croix Blanche-plein Ciel-sud-est",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"41.5",
		"CHOMAGE_2012":18.2
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.6402439,
              48.5438117
            ],
            [
              2.6438718,
              48.5442274
            ],
            [
              2.6449256,
              48.5446624
            ],
            [
              2.6460348,
              48.5449175
            ],
            [
              2.646522,
              48.545
            ],
            [
              2.6475235,
              48.5451559
            ],
            [
              2.6477304,
              48.5451913
            ],
            [
              2.6477837,
              48.5451799
            ],
            [
              2.6469425,
              48.5412054
            ],
            [
              2.6487862,
              48.5395527
            ],
            [
              2.648754,
              48.5393938
            ],
            [
              2.6485646,
              48.5394107
            ],
            [
              2.641411,
              48.5395602
            ],
            [
              2.6402439,
              48.5438117
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "GID": 255337,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0201",
        "DCOMIRIS": 772850201,
        "NOM_IRIS": "CROIX BLANCHE-PLEIN CIEL-NORD-OUEST",
        "TYP_IRIS": "H",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Croix Blanche-plein Ciel-nord-ouest",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"43.8",
		"CHOMAGE_2012":19
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.6402439,
              48.5438117
            ],
            [
              2.6315937,
              48.5428407
            ],
            [
              2.6318119,
              48.5445685
            ],
            [
              2.6328548,
              48.5465418
            ],
            [
              2.6350676,
              48.547853
            ],
            [
              2.6401444,
              48.5484442
            ],
            [
              2.6395309,
              48.547021
            ],
            [
              2.6402439,
              48.5438117
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "GID": 255338,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0202",
        "DCOMIRIS": 772850202,
        "NOM_IRIS": "CROIX BLANCHE-PLEIN CIEL-NORD EST",
        "TYP_IRIS": "H",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Croix Blanche-plein Ciel-nord Est",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"36.9",
		"CHOMAGE_2012":17.5
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.6416021,
              48.5493235
            ],
            [
              2.6434447,
              48.5487408
            ],
            [
              2.6444355,
              48.5467977
            ],
            [
              2.6476425,
              48.5452101
            ],
            [
              2.6477304,
              48.5451913
            ],
            [
              2.6475235,
              48.5451559
            ],
            [
              2.646522,
              48.545
            ],
            [
              2.6460348,
              48.5449175
            ],
            [
              2.6449256,
              48.5446624
            ],
            [
              2.6438718,
              48.5442274
            ],
            [
              2.6402439,
              48.5438117
            ],
            [
              2.6395309,
              48.547021
            ],
            [
              2.6401444,
              48.5484442
            ],
            [
              2.6417162,
              48.5484129
            ],
            [
              2.6415614,
              48.5492671
            ],
            [
              2.6416021,
              48.5493235
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "GID": 255339,
        "DEPCOM": 77285,
        "NOM_COM": "Le M\u00e9e-sur-Seine",
        "IRIS": "0203",
        "DCOMIRIS": 772850203,
        "NOM_IRIS": "CROIX BLANCHE-PLEIN CIEL-SUD-OUEST",
        "TYP_IRIS": "H",
        "ORIGINE": null,
        "NOM_LONG": "Le M\u00e9e-sur-seine - Croix Blanche-plein Ciel-sud-ouest",
        "DEP": 77,
        "NOM_POSTE": "LE MEE SUR SEINE",
        "CP": 77350,
        "LIBELLE": "LE MEE SUR SEINE",
		"MENAGES_NON_IMPOSES_2010":"38.7",
		"CHOMAGE_2012":18.7
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              2.6315937,
              48.5428407
            ],
            [
              2.6402439,
              48.5438117
            ],
            [
              2.641411,
              48.5395602
            ],
            [
              2.6366302,
              48.5393928
            ],
            [
              2.6295413,
              48.5380486
            ],
            [
              2.6312098,
              48.539646
            ],
            [
              2.6315937,
              48.5428407
            ]
          ]
        ]
      }
    }
  ]
},{style:function(feature){
var test;

if(feature.properties.MENAGES_NON_IMPOSES_2010 > 101){test= '#bd0026';}  
            else if(feature.properties.MENAGES_NON_IMPOSES_2010 > 80){test='#f03b20';}
             else if(feature.properties.MENAGES_NON_IMPOSES_2010 > 60){test='#fd8d3c';}
              else if(feature.properties.MENAGES_NON_IMPOSES_2010 > 40){test='#fecc5c';}
               else if(feature.properties.MENAGES_NON_IMPOSES_2010 > 20){test='#ffffb2';};

  return{
    fillColor: test,
        weight: 2,
        opacity: 1,

        color: 'white',
        dashArray: '3',
        fillOpacity: 0.5}
}}
  );


//L.control.layers(baseMaps, overlayMaps).addTo(map);

  

		var markers = L.markerClusterGroup({ chunkedLoading: true,
            
            iconCreateFunction: function (cluster) {
            var markers = cluster.getAllChildMarkers();
            var html = '<div class="circle">' + markers.length + '</div>';
            return L.divIcon({ html: html, className: 'mycluster', iconSize: L.point(32, 32) });
             },
            spiderfyOnMaxZoom: true, showCoverageOnHover: true, zoomToBoundsOnClick: true 
            });
 
        var markers_f = L.markerClusterGroup({ chunkedLoading: true,       
            iconCreateFunction: function (cluster) {
            var markers = cluster.getAllChildMarkers();
            var html = '<div class="circle_f">' + markers.length + '</div>';
            return L.divIcon({ html: html, className: 'mycluster', iconSize: L.point(32, 32) });
             },
            spiderfyOnMaxZoom: true, showCoverageOnHover: true, zoomToBoundsOnClick: true 
            });


		var markers_securite = L.markerClusterGroup({ chunkedLoading: true,
            
            iconCreateFunction: function (cluster) {
            var markers = cluster.getAllChildMarkers();
            var html = '<div class="circle_securite">' + markers.length + '</div>';
            return L.divIcon({ html: html, className: 'mycluster', iconSize: L.point(32, 32) });
             },
            spiderfyOnMaxZoom: true, showCoverageOnHover: true, zoomToBoundsOnClick: true 
            });

			var markers_economie = L.markerClusterGroup({ chunkedLoading: true,
            
            iconCreateFunction: function (cluster) {
            var markers = cluster.getAllChildMarkers();
            var html = '<div class="circle_emploi">' + markers.length + '</div>';
            return L.divIcon({ html: html, className: 'mycluster', iconSize: L.point(32, 32) });
             },
            spiderfyOnMaxZoom: true, showCoverageOnHover: true, zoomToBoundsOnClick: true 
            });
		
		for (var i = 0; i < addressPoints.length; i++) {
			var a = addressPoints[i];
			var title = a[2];
			var name = a[3];
			var concerne = a[4];
			var marker = L.marker(L.latLng(a[0], a[1]), { title: title });
			marker.bindPopup(name+'<br>'+title);
            if(title=="F"){
                markers_f.addLayer(marker);
            }else if (title=="M"){
                markers.addLayer(marker);
            }

			if(concerne=="Sécutite"){
                markers_securite.addLayer(marker);
            }
			else if(concerne=="Economie"){
                markers_economie.addLayer(marker);
            }
			
		}

var securite = new L.LayerGroup();
var economie = new L.LayerGroup();
	
		//map.addLayer(markers);
        //map.addLayer(markers_f);
		markers.addTo(cities);
		markers_f.addTo(cities);
		markers_securite.addTo(securite);
		markers_economie.addTo(economie);

		var baseLayers = {
		"Carte": tiles,

	};

	var overlays = {
		"Impots 2010":impot,
		"Votant Homme et Femme": cities,
		"Securite": securite,
		"Emploi": economie
	};

	var toto = L.control.layers(baseLayers, overlays).addTo(map);

var legend = L.control({position: 'topright'});
  legend.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'info legend');
      div.innerHTML = '% Menages non imposes 2010<br>';
        div.innerHTML +='<i style="background:#bd0026"></i>100% a 80% <br>';   
        div.innerHTML +='<i style="background:#f03b20"></i>80% a 60% <br>';
          div.innerHTML +='<i style="background:#fecc5c"></i>60% a 40% <br>';
            div.innerHTML +='<i style="background:#fecc5c"></i>40% a 20% <br>';
              div.innerHTML +='<i style="background:#ffffb2"></i>20% a 0% <br>';
    return div;
};

legend.addTo(map);

		


	</script>
</body>
</html>
